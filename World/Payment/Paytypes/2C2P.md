# 2C2P 文件

## 目錄
1. [資料表 Paytype](#1-資料表-paytype)
2. [退款 NMQ](#2-退款-nmq)
3. [錯誤紀錄](#3-錯誤紀錄)
4. [退款方式](#4-退款方式)

<br>

---

## 1. 資料表 Paytype

TwoCTwoP

<br>

---

## 2. 退款 NMQ

**Job_Id:** 440

<br>

**Job_Name:** TwoCTwoPRefundRequestFinish

<br>

**Job_Description:** PaymentMiddleware退款完成

<br>

**Job_ClassName:** NineYi.SCM.Frontend.NMQV2.ThirdPartyPayments.PaymentMiddleWareRefundRequestFinishProcess

<br>

**Task Data:**
```json
{"RefundRequestIds":[121537],"TradesOrderGroupId":1476443,"PayType":"TwoCTwoP"}
```

<br>

---

## 3. 錯誤紀錄

### 3.1 餘額不足無法退款

**訊息:** 46,Insufficient funds to perform refund.

<br>

paymentmilldeware : "46" => ReturnCodes.RefundPending

<br>

會待下一次再確認

<br>

---

## 4. 退款方式

執行退款前，會先跑 this.Refund，確認該筆交易訂單已經是 Settled 狀態

<br>

status = "S"，才會進行退款否則會等待下一輪再確認

<br>